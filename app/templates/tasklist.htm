<!--一覧表示ページ-->
{% extends "_base.htm" %}
{% block bodycontent %}
<div class="row">
  <div id="taskmain" class="col-sm-12 col-md-10" style="left:1vw; overflow: hidden;">
    <div class="container">
      <div class="d-flex">
        <h6 id="searchlabel">しぼりこみ検索</h6>
        <!--曜日しぼりこみ-->
        <div class="form-group">
          <label for="select0a">科目</label>
          <select id="select0a" class="form-control" onchange="location.href=value;">
            <option value="/tasklist">全ての曜日</option>
            <option value="/tasklist/day/mon" {% if day=='mon' %}selected{% endif %}>月曜のみ</option>
            <option value="/tasklist/day/tue" {% if day=='tue' %}selected{% endif %}>火曜のみ</option>
            <option value="/tasklist/day/wed" {% if day=='wed' %}selected{% endif %}>水曜のみ</option>
            <option value="/tasklist/day/thu" {% if day=='thu' %}selected{% endif %}>木曜のみ</option>
            <option value="/tasklist/day/fri" {% if day=='fri' %}selected{% endif %}>金曜のみ</option>
          </select>
        </div>
        <!--時間割検索機能-->
        <button id="timesearchbutton" type="button" class="btn btn-dark" data-toggle="modal"
          data-target="#modal_timeboard_select">時間割で検索</button>
      </div>
    </div>
    <!--タイトル-->
    <h3>あなたの課題</h3>
    <b>検索条件：{{ search_condition }}</b>

    <!--アラート-->
    {% set tasknum = namespace(cnt = 0) %}
    {% for task in tasks %}
    {% set tasknum.cnt = tasknum.cnt + 1 %}
    {% endfor %}
    {% if tasknum.cnt > 0 %}

    <div class="alert alert-danger" role="alert">
      <div class="row">
        {% if search_condition == '全て' %}
        未完了の課題が<div class="text-danger">{{ tasknum.cnt }}</div>件あります
        {% else %}
        この条件での未完了課題が<div class="text-danger">{{ tasknum.cnt }}</div>件あります
        {% endif %}
      </div>
    </div>
    <div class="table-responsive table-sm table-bordered">
      <table class="table">
        <thead>
          <tr class="d-flex">
            <th class="col-3">科目名</th>
            <th class="col-3">課題名</th>

            <th class="col-3">
              <div class="form-group">
                <label for="select3a">締め切りまで:</label>
                <select id="select3a" class="form-control">
                  <option>全て</option>
                  <option>未完了のみ</option>
                  <option>今日中</option>
                  <option>1週間以内</option>
                </select>
              </div>
            </th>
            <th class="col-3">締切日</th>
          </tr>
        </thead>
        <tbody id="dragArea">
          <!--2020/12/03 trにidを追加しました。URLをそのままidとして使います。テンプレートに渡すデータに.searchURLを追加してください-->
          {% for task in tasks %}
          <tr id='{{task.searchURL}}' class="d-flex tablecontents" draggable="true">
            <td class="col-3">{{task.subject}}</td>
            <td class="col-3"><a>{{task.taskname}}</a></td>
            <td class="col-3">{{task.time_left}}</td>
            <td class="col-3">{{task.deadline}}</td>
          </tr>
          {% endfor %}
      </table>
    </div>

    {% else %}
    <div class="alert alert-success" role="alert">
      {% if search_condition == '全て' %}
      未完了の課題はありません!
      {% else %}
      この条件で未完了課題はありません!
      {% endif %}
    </div>
    {% endif %}
    <!--課題表-->
  </div>

  <div class="col-md-1 border-left d-none d-md-block">
    <div ondragover="return false" class="container" id="dastshoot">
      <div class="row">
        <i class="fas fa-9x fa-dumpster mr-auto" style="color: black;"></i>
        <div class="my-auto mr-auto" style="font-size:x-large; color: coral;"><b>6</b></div>
        <div>ここに課題をドラッグ＆ドロップする</div>
        <h5 class="text-nowrap pt-3 border-top">・完了済みにする課題</h5>
        <ul class="list-group" id="finished_taskslist">
          <div class="mx-auto">
            <div class="row">
              <li class="list-group-item finished-list-item">
                [2020後期月3]線形代数学<br>
                <b>課題No.6</b>
              </li>
              <button><i class="fas fa-times"></i></button>
            </div>
          </div>
          <div class="mx-auto">
            <div class="row">
              <li class="list-group-item finished-list-item">
                [2020後期月3]線形代数学<br>
                <b>課題No.6</b>
              </li>
              <button><i class="fas fa-times"></i></button>
            </div>
          </div>
          <div class="mx-auto">
            <div class="row">
              <li class="list-group-item finished-list-item">
                [2020後期月3]線形代数学<br>
                <b>課題No.6</b>
              </li>
              <button><i class="fas fa-times"></i></button>
            </div>
          </div>
          <div class="mx-auto">
            <div class="row">
              <li class="list-group-item finished-list-item">
                [2020後期月3]線形代数学<br>
                <b>課題No.6</b>
              </li>
              <button><i class="fas fa-times"></i></button>
            </div>
          </div>
          <div class="mx-auto">
            <div class="row">
              <li class="list-group-item finished-list-item">
                [2020後期月3]線形代数学<br>
                <b>課題No.6</b>
              </li>
              <button><i class="fas fa-times"></i></button>
            </div>
          </div>
        </ul>
        <button type="button" class="btn btn-success btn-block mx-auto mt-3" style="font-size: smaller;">確定する</button>
      </div>

    </div>
  </div>

  <script type="text/javascript" src="/static/js/f_tasks.js"></script>
  {% endblock %}