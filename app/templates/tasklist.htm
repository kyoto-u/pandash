<!--一覧表示ページ-->
{% extends "_base.htm" %}
{% block bodycontent %}
<!--Modal-->
<div class="row">
  <div class="col-sm-12 col-md-2" id="ScrollSearchbar">
    <div class="container">
      <div class="d-flex flex-md-column">
        <h6 id="searchlabel">しぼりこみ検索</h6>
        <!--曜日しぼりこみ-->
        <div class="form-group">
          <label for="select0a">科目</label>
          <select id="select0a" class="form-control" onchange="location.href=value;">
            <option value="/tasklist">全ての曜日</option>
            <option value="/tasklist/day/mon" {% if day=='mon' %}selected{% endif %}>月曜のみ</option>
            <option value="/tasklist/day/tue" {% if day=='tue' %}selected{% endif %}>火曜のみ</option>
            <option value="/tasklist/day/wed" {% if day=='wed' %}selected{% endif %}>水曜のみ</option>
            <option value="/tasklist/day/thu" {% if day=='thu' %}selected{% endif %}>木曜のみ</option>
            <option value="/tasklist/day/fri" {% if day=='fri' %}selected{% endif %}>金曜のみ</option>
          </select>
        </div>
        <!--時間割検索機能-->
        <button id="timesearchbutton" type="button" class="btn btn-dark" data-toggle="modal"
          data-target="#modal_timeboard_select">時間割で検索</button>
        <form id="finish_form">
          <div class="d-none d-md-block" id="tali_flag">
              <div class="container" id="finish_tasks">
                <div class="d-flex align-items-center">
                  <i class="fas fa-flag-checkered">ここに課題をドラッグ＆ドロップして完了済みにする</i>
                </div>
              </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  <div id="taskmain" class="col-sm-12 col-md-10">
    <!--タイトル-->
    <h3>あなたの課題</h3>
    <b>検索条件：{{ search_condition.search_condition }}</b>

    <!--アラート-->
    {% set tasknum = namespace(cnt = 0) %}
    {% for task in tasks %}
    {% set tasknum.cnt = tasknum.cnt + 1 %}
    {% endfor %}
    {% if tasknum.cnt > 0 %}
    <div class="alert alert-danger" role="alert">
      <div class="row">

        この条件での未完了課題が<div class="text-danger">{{ tasknum.cnt }}</div>件あります
        未完了の課題が<div class="text-danger">{{ tasknum.cnt }}</div>件あります
      </div>
    </div>
    <div class="table-responsive table-sm table-bordered">
      <table class="table">
        <thead>
          <tr class="d-flex">
            <th class="col-3">科目名</th>
            <th class="col-3">課題名</th>

            <th class="col-3">
              <div class="form-group">
                <label for="select3a">締め切りまで:</label>
                <select id="select3a" class="form-control" onchange="return select3a_change(this.value);">
                  <option value="show-only-0" {% if search_condition.select3a_judge==0 %}selected{% endif %}>全て</option>
                  <option value="show-only-1" {% if search_condition.select3a_judge==1 %}selected{% endif %}>未完了のみ</option>
                  <option value="max-1" {% if search_condition.select3a_judge==3 %}selected{% endif %}>今日中</option>
                  <option value="max-2" {% if search_condition.select3a_judge==4 %}selected{% endif %}>1週間以内</option>
                </select>
              </div>
            </th>
            <th class="col-3">締切日</th>
          </tr>
        </thead>
        <tbody id="dragArea">
          {% for task in tasks %}
          <tr class="d-flex tablecontents acdrag">
            <td class="col-3">{{task.subject}}</td>
            <td class="col-3 task_title"><a href="{{task.assignmentid}}" class="task_tag">{{task.taskname}}</a></td>
            <td class="col-3">{{task.time_left}}</td>
            <td class="col-3">{{task.deadline}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
  {% else %}
  <div class="alert alert-success" role="alert">
    この条件で未完了課題はありません!
  </div>
  {% endif %}
  <!--課題表-->
</div>

  <script type="text/javascript" src="/static/js/task.js"></script>
  {% endblock %}